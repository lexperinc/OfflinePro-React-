import React, { useState, useEffect, useRef, useCallback, useMemo } from 'react';
import { 
  Gamepad2, Brain, Wind, Menu, X, Zap, TrendingUp, Trophy,
  RefreshCw, Lightbulb, Ghost, Server, Cpu, MousePointer, 
  BookOpen, Activity, Save, Trash2, Clock, 
  Grid3X3, Play, Pause, RotateCcw, Minus, Shield, Dice5, Key, Edit
} from 'lucide-react';

// --- GENÄ°ÅžLETÄ°LMÄ°Åž VERÄ° TABANI ---
const RIDDLES = [
  { q: "Bilgi verir, aÄŸzÄ± yok. YapraÄŸÄ± var, aÄŸacÄ± yok.", a: "Kitap" },
  { q: "Ã‡arÅŸÄ±dan aldÄ±m bir tane, eve geldim bin tane.", a: "Nar" },
  { q: "KuyruÄŸu var, canlÄ± deÄŸil. KonuÅŸur ama insan deÄŸil.", a: "Radyo" },
  { q: "Yer altÄ±nda sakallÄ± dede.", a: "PÄ±rasa" },
  { q: "DÄ±ÅŸÄ± var iÃ§i yok, tekme yer suÃ§u yok.", a: "Top" },
  { q: "Hangi macun yenmez?", a: "Lahmacun" },
  { q: "Salyangozlar 3 yÄ±l boyunca ne yapabilir?", a: "Uyuyabilir" },
  { q: "YazÄ±n giyinir, kÄ±ÅŸÄ±n soyunur.", a: "AÄŸaÃ§" },
  { q: "Hangi ayda 28 gÃ¼n vardÄ±r?", a: "Hepsinde" },
  { q: "Kolu var, bacaÄŸÄ± yok. DikdÃ¶rtgeni var, karesi yok.", a: "KapÄ±" },
  { q: "Uzaktan baktÄ±m hiÃ§ yok, yakÄ±ndan baktÄ±m pek Ã§ok.", a: "KarÄ±nca" },
  { q: "BaÄŸlarÄ±m yÃ¼rÃ¼r, Ã§Ã¶zerim durur.", a: "AyakkabÄ±" },
  { q: "Benim adÄ±m iki hece, Ã§alÄ±ÅŸÄ±rÄ±m gÃ¼ndÃ¼z gece.", a: "Saat" },
  { q: "KÃ¼Ã§Ã¼cÃ¼k fÄ±Ã§Ä±cÄ±k, iÃ§i dolu turÅŸucuk.", a: "Limon" },
  { q: "Tarlada yeÅŸil, Ã§arÅŸÄ±da siyah, evde kÄ±rmÄ±zÄ±.", a: "Ã‡ay" },
  { q: "Ä°Ã§ini boÅŸaltÄ±nca bÃ¼yÃ¼yen ÅŸey nedir?", a: "Ã‡ukur" }
];

const FACTS = [
  "AhtapotlarÄ±n Ã¼Ã§ kalbi vardÄ±r.",
  "Bal bozulmayan tek gÄ±dadÄ±r. 3000 yÄ±llÄ±k bal yenilebilir bulunmuÅŸtur.",
  "Kutup ayÄ±larÄ± aslÄ±nda solaktÄ±r.",
  "Ã‡akmak kibritten Ã¶nce bulunmuÅŸtur.",
  "Su aygÄ±rlarÄ±nÄ±n sÃ¼tÃ¼ pembe renklidir.",
  "Mavi balinalarÄ±n dili bir Afrika fili kadar aÄŸÄ±rdÄ±r.",
  "Ä°nsan DNA'sÄ± ile muz DNA'sÄ± %50 oranÄ±nda benzerdir.",
  "VenÃ¼s gezegeninde bir gÃ¼n, bir yÄ±ldan daha uzundur.",
  "KetÃ§ap 1830'larda ilaÃ§ olarak satÄ±lÄ±yordu.",
  "Ã–rdeklerin vakvak sesi yankÄ± yapmaz.",
  "SÄ±cak su, soÄŸuk sudan daha hÄ±zlÄ± donar (Mpemba etkisi).",
  "Ä°nsan vÃ¼cudundaki kemiklerin %25'i ayaklardadÄ±r.",
  "Eyfel Kulesi yazÄ±n sÄ±caktan dolayÄ± 15 cm uzar.",
  "Timsahlar dillerini dÄ±ÅŸarÄ± Ã§Ä±karamazlar.",
  "Kelebekler ayaklarÄ±yla tat alÄ±rlar.",
  "DÃ¼nyadaki en kÄ±sa savaÅŸ 38 dakika sÃ¼rmÃ¼ÅŸtÃ¼r.",
  "Kangurular geri geri yÃ¼rÃ¼yemezler.",
  "Bir bulutun aÄŸÄ±rlÄ±ÄŸÄ± yaklaÅŸÄ±k 500 tondur."
];

const BUILDING_TYPES = [
  { id: 1, name: 'PaslÄ± Kazma', baseCost: 15, income: 0.5, icon: <Zap size={16}/>, color: "text-yellow-400" },
  { id: 2, name: 'Eski Laptop', baseCost: 100, income: 3, icon: <MousePointer size={16}/>, color: "text-blue-400" },
  { id: 3, name: 'Ekran KartÄ±', baseCost: 500, income: 10, icon: <Cpu size={16}/>, color: "text-green-400" },
  { id: 4, name: 'Server OdasÄ±', baseCost: 2000, income: 50, icon: <Server size={16}/>, color: "text-purple-400" },
  { id: 5, name: 'Kuantum PC', baseCost: 10000, income: 250, icon: <Brain size={16}/>, color: "text-pink-400" },
];

const CLICK_UPGRADE = {
  name: 'TÄ±klama GÃ¼cÃ¼ YÃ¼kseltmesi',
  baseCost: 50,
  baseDamage: 1,
  costMultiplier: 1.5,
  damageIncrease: 0.5,
};

// --- ORTAK BÄ°LEÅžENLER ---
const Card = ({ children, className = "" }) => (
  <div className={`bg-gray-800/60 backdrop-blur-md border border-gray-700/50 rounded-xl shadow-xl overflow-hidden ${className}`}>
    {children}
  </div>
);

const Button = ({ onClick, children, variant = "primary", className = "", disabled = false }) => {
  const baseStyle = "px-4 py-2 rounded-lg font-bold transition-all active:scale-95 flex items-center justify-center gap-2 select-none";
  const variants = {
    primary: "bg-blue-600 hover:bg-blue-500 text-white shadow-lg shadow-blue-900/50",
    secondary: "bg-gray-700 hover:bg-gray-600 text-white border border-gray-600",
    danger: "bg-red-600 hover:bg-red-500 text-white",
    outline: "border-2 border-gray-600 text-gray-300 hover:border-gray-400 hover:text-white bg-transparent",
    success: "bg-green-600 hover:bg-green-500 text-white",
    info: "bg-yellow-600 hover:bg-yellow-500 text-white"
  };
  
  return (
    <button 
      onClick={onClick} 
      disabled={disabled}
      className={`${baseStyle} ${variants[variant]} ${disabled ? 'opacity-50 cursor-not-allowed scale-100' : ''} ${className}`}
    >
      {children}
    </button>
  );
};

// --- GELÄ°ÅžTÄ°RÄ°LMÄ°Åž CLICKER OYUNU ---
const ClickerGame = () => {
  const [points, setPoints] = useState(0);
  const [inventory, setInventory] = useState({ 1: 0, 2: 0, 3: 0, 4: 0, 5: 0 });
  const [clickLevel, setClickLevel] = useState(1);
  const [popups, setPopups] = useState([]); 
  const [combo, setCombo] = useState(0);
  const comboTimeout = useRef(null);

  const clickBaseDamage = useMemo(() => CLICK_UPGRADE.baseDamage + (clickLevel - 1) * CLICK_UPGRADE.damageIncrease, [clickLevel]);
  const clickUpgradeCost = Math.floor(CLICK_UPGRADE.baseCost * Math.pow(CLICK_UPGRADE.costMultiplier, clickLevel - 1));
  
  const cps = BUILDING_TYPES.reduce((acc, type) => acc + (type.income * (inventory[type.id] || 0)), 0);

  // Load Save
  useEffect(() => {
    try {
      const savedData = localStorage.getItem('minerSave_v5');
      if (savedData) {
        const parsed = JSON.parse(savedData);
        if (parsed?.points) setPoints(parsed.points);
        if (parsed?.inventory) setInventory(parsed.inventory);
        if (parsed?.clickLevel) setClickLevel(parsed.clickLevel);
      }
    } catch (e) { console.error("Save load error", e); }
  }, []);

  // Save Game
  useEffect(() => {
    localStorage.setItem('minerSave_v5', JSON.stringify({ points, inventory, clickLevel }));
  }, [points, inventory, clickLevel]);

  // CPS Tick
  useEffect(() => {
    if (cps === 0) return;
    const interval = setInterval(() => setPoints(p => p + (cps / 10)), 100);
    return () => clearInterval(interval);
  }, [cps]);

  const handleMainClick = (e) => {
    const CRIT_CHANCE = 0.05; // 5%
    const CRIT_MULTIPLIER = 5;
    const COMBO_BONUS_PER_HIT = 0.02; // 2% per combo
    const MAX_COMBO_BONUS = 0.50; // Max 50%

    const isCrit = Math.random() < CRIT_CHANCE;
    const critMult = isCrit ? CRIT_MULTIPLIER : 1;
    
    // Combo bonus (her vuruÅŸ %2 artÄ±rÄ±r, max %50)
    const currentComboBonus = 1 + Math.min(combo * COMBO_BONUS_PER_HIT, MAX_COMBO_BONUS);
    
    const baseGain = clickBaseDamage + (cps * 0.05); // CPS also adds a tiny base gain
    const totalGain = baseGain * critMult * currentComboBonus;

    setPoints(p => p + totalGain);
    setCombo(c => c + 1);

    // Combo reset timer
    if (comboTimeout.current) clearTimeout(comboTimeout.current);
    comboTimeout.current = setTimeout(() => setCombo(0), 1000);

    // GÃ¶rsel Efekt
    const id = Date.now();
    const rect = e.currentTarget.getBoundingClientRect();
    const x = e.clientX ? e.clientX - rect.left : rect.width / 2;
    const y = e.clientY ? e.clientY - rect.top : rect.height / 2;
    
    setPopups(prev => [...prev, { id, x, y, val: totalGain.toFixed(1), isCrit }]);
    setTimeout(() => setPopups(prev => prev.filter(p => p.id !== id)), 800);
  };

  const buyBuilding = (id) => {
    const type = BUILDING_TYPES.find(b => b.id === id);
    const count = inventory[id] || 0;
    const cost = Math.floor(type.baseCost * Math.pow(1.15, count));

    if (points >= cost) {
      setPoints(p => p - cost);
      setInventory(prev => ({ ...prev, [id]: count + 1 }));
    }
  };
  
  const buyClickUpgrade = () => {
    if (points >= clickUpgradeCost) {
      setPoints(p => p - clickUpgradeCost);
      setClickLevel(l => l + 1);
    }
  };

  return (
    <div className="flex flex-col h-full space-y-4 p-4 animate-fade-in select-none">
      {/* Header Stats */}
      <Card className="p-4 flex flex-col items-center bg-gradient-to-r from-gray-900 to-gray-800 border-blue-500/20 sticky top-0 z-10">
        <div className="text-4xl md:text-5xl font-mono text-transparent bg-clip-text bg-gradient-to-r from-green-400 to-blue-500 font-bold mb-2">
          {Math.floor(points).toLocaleString()}
        </div>
        <div className="flex justify-between w-full px-4 text-xs font-mono">
           <div className="flex items-center gap-1 text-blue-300"><TrendingUp size={14} /> {cps.toFixed(1)}/sn</div>
           <div className="flex items-center gap-1 text-green-300"><MousePointer size={14} /> TÄ±klama: {clickBaseDamage.toFixed(1)}</div>
           <div className={`flex items-center gap-1 ${combo > 5 ? 'text-yellow-400 animate-pulse' : 'text-gray-500'}`}>
             <Zap size={14} /> Kombo: x{(1 + Math.min(combo * 0.02, 0.5)).toFixed(2)}
           </div>
        </div>
      </Card>

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-4 flex-1 overflow-hidden">
        {/* Click Area */}
        <div className="flex flex-col items-center justify-center rounded-xl relative py-4">
          <button 
            onMouseDown={handleMainClick} // Mobilde touchstart da tetikleyebilir ama React onClick genelde yeterlidir. Daha seri olmasÄ± iÃ§in onMouseDown.
            className="relative group active:scale-95 transition-all duration-75 outline-none tap-highlight-transparent"
            style={{ WebkitTapHighlightColor: 'transparent' }}
          >
            <div className="absolute inset-0 bg-blue-500 blur-[60px] opacity-20 group-hover:opacity-40 transition-opacity rounded-full"></div>
            <div className="bg-gradient-to-br from-gray-800 to-black border-4 border-gray-700 w-56 h-56 md:w-64 md:h-64 rounded-full flex flex-col items-center justify-center shadow-2xl relative z-10 overflow-hidden group-hover:border-blue-500/50 transition-colors">
              <Gamepad2 size={64} className="text-blue-500 mb-2 group-hover:text-white transition-colors" />
              <span className="text-2xl font-bold text-gray-200">KAZI YAP</span>
              <span className="text-xs text-gray-400 mt-1">LVL {clickLevel}</span>
              
              {popups.map(p => (
                <div 
                  key={p.id} 
                  className={`absolute font-bold text-xl pointer-events-none animate-float-up ${p.isCrit ? 'text-yellow-400 text-3xl z-20 shadow-text' : 'text-green-400'}`}
                  style={{ left: p.x, top: p.y }}
                >
                  {p.isCrit ? 'KRÄ°TÄ°K! ' : '+'}{p.val}
                </div>
              ))}
            </div>
          </button>
        </div>

        {/* Market & Upgrades */}
        <Card className="flex flex-col border-gray-700 bg-gray-900/50 h-[300px] lg:h-auto">
          <div className="p-3 bg-gray-800/80 border-b border-gray-700 font-bold text-gray-300 flex justify-between items-center backdrop-blur">
            <span className="flex items-center gap-2"><RefreshCw size={16}/> Market ve YÃ¼kseltmeler</span>
          </div>
          <div className="overflow-y-auto p-2 space-y-2 flex-1 custom-scrollbar">
            {/* Click Upgrade */}
            <button 
              disabled={points < clickUpgradeCost}
              onClick={buyClickUpgrade}
              className={`w-full flex items-center justify-between p-3 rounded-lg border transition-all duration-200 group ${
                points >= clickUpgradeCost 
                ? 'bg-blue-900/30 border-blue-700/50 hover:bg-blue-800/50' 
                : 'bg-gray-900/50 border-gray-800 opacity-60 cursor-not-allowed'
              }`}
            >
              <div className="flex items-center gap-3">
                <div className={`p-2 rounded-lg bg-gray-900 text-red-400 group-hover:scale-110 transition-transform`}><MousePointer size={16}/></div>
                <div className="text-left">
                  <div className="font-bold text-gray-200 text-sm">TÄ±klama GÃ¼cÃ¼ YÃ¼kseltmesi</div>
                  <div className="text-xs text-gray-400">LVL {clickLevel} (+{CLICK_UPGRADE.damageIncrease} TÄ±klama HasarÄ±)</div>
                </div>
              </div>
              <div className="text-right">
                <div className={`${points >= clickUpgradeCost ? 'text-green-400' : 'text-red-400'} font-mono font-bold text-sm`}>{clickUpgradeCost.toLocaleString()}</div>
                <div className="text-xs text-gray-500">Maliyet</div>
              </div>
            </button>
            
            <div className="text-xs font-bold text-gray-600 uppercase tracking-wider px-2 py-1 mt-4">Otomatik KazanÃ§ (CPS)</div>
            {BUILDING_TYPES.map(b => {
              const count = inventory[b.id] || 0;
              const cost = Math.floor(b.baseCost * Math.pow(1.15, count));
              const canAfford = points >= cost;
              return (
                <button 
                  key={b.id}
                  disabled={!canAfford}
                  onClick={() => buyBuilding(b.id)}
                  className={`w-full flex items-center justify-between p-3 rounded-lg border transition-all duration-200 group ${
                    canAfford 
                    ? 'bg-gray-800 border-gray-700 hover:bg-gray-700 hover:border-blue-500/50' 
                    : 'bg-gray-900/50 border-gray-800 opacity-40 cursor-not-allowed'
                  }`}
                >
                  <div className="flex items-center gap-3">
                    <div className={`p-2 rounded-lg bg-gray-900 ${b.color} group-hover:scale-110 transition-transform`}>{b.icon}</div>
                    <div className="text-left">
                      <div className="font-bold text-gray-200 text-sm">{b.name}</div>
                      <div className="text-xs text-gray-400">+{b.income} / sn</div>
                    </div>
                  </div>
                  <div className="text-right">
                    <div className={`${canAfford ? 'text-green-400' : 'text-red-400'} font-mono font-bold text-sm`}>{cost.toLocaleString()}</div>
                    <div className="text-xs text-gray-500">Adet: {count}</div>
                  </div>
                </button>
              )
            })}
          </div>
        </Card>
      </div>
    </div>
  );
};

// --- YILAN OYUNU (DEÄžÄ°ÅžMEDÄ°) ---
const SnakeGame = () => {
  const [snake, setSnake] = useState([[10, 10]]);
  const [food, setFood] = useState([15, 15]);
  const [dir, setDir] = useState([0, 1]); 
  const [gameOver, setGameOver] = useState(false);
  const [paused, setPaused] = useState(false);
  const [score, setScore] = useState(0);
  const [highScore, setHighScore] = useState(parseInt(localStorage.getItem('snakeHigh') || '0'));
  const [difficulty, setDifficulty] = useState('normal'); // easy, normal, hard
  const [gameStarted, setGameStarted] = useState(false);
  const boardSize = 20;

  const speeds = { easy: 200, normal: 130, hard: 70 };

  const moveSnake = useCallback(() => {
    if (gameOver || paused || !gameStarted) return;

    const newHead = [snake[0][0] + dir[0], snake[0][1] + dir[1]];

    if (
      newHead[0] < 0 || newHead[0] >= boardSize ||
      newHead[1] < 0 || newHead[1] >= boardSize ||
      snake.some(s => s[0] === newHead[0] && s[1] === newHead[1])
    ) {
      setGameOver(true);
      if (score > highScore) {
        setHighScore(score);
        localStorage.setItem('snakeHigh', score);
      }
      return;
    }

    const newSnake = [newHead, ...snake];
    if (newHead[0] === food[0] && newHead[1] === food[1]) {
      setScore(s => s + (difficulty === 'hard' ? 3 : difficulty === 'normal' ? 2 : 1));
      let newFood;
      do {
        newFood = [Math.floor(Math.random() * boardSize), Math.floor(Math.random() * boardSize)];
      } while (newSnake.some(s => s[0] === newFood[0] && s[1] === newFood[1]));
      setFood(newFood);
    } else {
      newSnake.pop();
    }
    setSnake(newSnake);
  }, [snake, dir, food, gameOver, paused, gameStarted, score, highScore, difficulty]);

  useEffect(() => {
    const interval = setInterval(moveSnake, speeds[difficulty]);
    return () => clearInterval(interval);
  }, [moveSnake, difficulty]);

  useEffect(() => {
    const handleKey = (e) => {
      if(e.key === " ") { setPaused(p => !p); return; }
      const map = { 'ArrowUp': [-1, 0], 'ArrowDown': [1, 0], 'ArrowLeft': [0, -1], 'ArrowRight': [0, 1] };
      const newDir = map[e.key];
      if (newDir) {
        if (snake.length > 1 && (newDir[0] === -dir[0] && newDir[1] === -dir[1])) return;
        setDir(newDir);
        if(!gameStarted && !gameOver) setGameStarted(true);
      }
    };
    window.addEventListener('keydown', handleKey);
    return () => window.removeEventListener('keydown', handleKey);
  }, [dir, snake, gameStarted, gameOver]);

  const handleTouch = (d) => {
    const map = { 'U': [-1, 0], 'D': [1, 0], 'L': [0, -1], 'R': [0, 1] };
    const newDir = map[d];
    if (snake.length > 1 && (newDir[0] === -dir[0] && newDir[1] === -dir[1])) return;
    setDir(newDir);
    if(!gameStarted && !gameOver) setGameStarted(true);
  };

  const restart = () => {
    setSnake([[10,10]]); setGameOver(false); setScore(0); setDir([0,1]); setPaused(false); setGameStarted(false);
  };

  return (
    <div className="flex flex-col items-center justify-center h-full p-2 select-none">
      <div className="flex justify-between w-full max-w-[300px] mb-2 text-sm font-bold">
        <span className="text-green-400">Skor: {score}</span>
        <span className="text-yellow-500">Rekor: {highScore}</span>
      </div>
      
      <div className="relative shadow-2xl border-4 border-gray-700 rounded-lg overflow-hidden bg-gray-900">
        <div 
          className="grid"
          style={{ gridTemplateColumns: `repeat(${boardSize}, 1fr)`, width: '300px', height: '300px' }}
        >
          {Array.from({length: boardSize * boardSize}).map((_, i) => {
            const y = Math.floor(i / boardSize);
            const x = i % boardSize;
            const isHead = snake[0][0] === y && snake[0][1] === x;
            const isBody = snake.some((s, idx) => idx !== 0 && s[0] === y && s[1] === x);
            const isFood = food[0] === y && food[1] === x;
            
            let classes = "bg-transparent";
            if (isHead) classes = "bg-green-400 rounded-sm z-10";
            else if (isBody) classes = "bg-green-600 rounded-sm opacity-60";
            else if (isFood) classes = "bg-red-500 rounded-full scale-75 shadow-[0_0_10px_red] animate-pulse";

            return <div key={i} className={classes} />;
          })}
        </div>
        
        {/* Start / Game Over Overlay */}
        {(!gameStarted || gameOver || paused) && (
          <div className="absolute inset-0 bg-black/80 backdrop-blur-sm flex flex-col items-center justify-center animate-fade-in p-4 text-center z-20">
            <h3 className={`text-2xl font-bold mb-4 ${gameOver ? 'text-red-500' : 'text-blue-400'}`}>
              {gameOver ? "OYUN BÄ°TTÄ°" : paused ? "DURAKLATILDI" : "YILAN OYUNU"}
            </h3>
            
            {!gameStarted && !gameOver && !paused && (
               <div className="flex gap-2 mb-4">
                 {['easy', 'normal', 'hard'].map(d => (
                   <button 
                     key={d} 
                     onClick={() => setDifficulty(d)} 
                     className={`text-xs px-2 py-1 rounded border capitalize ${difficulty === d ? 'bg-blue-600 border-blue-600 text-white' : 'border-gray-600 text-gray-400'}`}
                   >
                     {d === 'easy' ? 'Kolay' : d === 'normal' ? 'Orta' : 'Zor'}
                   </button>
                 ))}
               </div>
            )}

            <Button onClick={gameOver ? restart : paused ? () => setPaused(false) : () => setGameStarted(true)} variant={gameOver ? 'danger' : 'success'}>
              {gameOver ? 'Tekrar Dene' : paused ? 'Devam Et' : 'BaÅŸla'}
            </Button>
          </div>
        )}
      </div>

      {/* Improved Mobile Controls */}
      <div className="grid grid-cols-3 gap-2 mt-4 w-56 h-40">
        <div className="col-start-2 row-start-1">
          <button onTouchStart={(e) => {e.preventDefault(); handleTouch('U')}} onMouseDown={() => handleTouch('U')} className="w-full h-full bg-gray-800 rounded-xl active:bg-blue-600 flex items-center justify-center border-b-4 border-black active:border-b-0 active:translate-y-1"><Minus className="rotate-90" /></button>
        </div>
        <div className="col-start-1 row-start-2">
          <button onTouchStart={(e) => {e.preventDefault(); handleTouch('L')}} onMouseDown={() => handleTouch('L')} className="w-full h-full bg-gray-800 rounded-xl active:bg-blue-600 flex items-center justify-center border-b-4 border-black active:border-b-0 active:translate-y-1"><Minus /></button>
        </div>
        <div className="col-start-2 row-start-2">
          <button onClick={() => {if(gameStarted && !gameOver) setPaused(p=>!p)}} className="w-full h-full bg-gray-900 rounded-full flex items-center justify-center text-yellow-500 border border-gray-700">
            {paused ? <Play size={20} /> : <Pause size={20} />}
          </button>
        </div>
        <div className="col-start-3 row-start-2">
          <button onTouchStart={(e) => {e.preventDefault(); handleTouch('R')}} onMouseDown={() => handleTouch('R')} className="w-full h-full bg-gray-800 rounded-xl active:bg-blue-600 flex items-center justify-center border-b-4 border-black active:border-b-0 active:translate-y-1"><Minus /></button>
        </div>
        <div className="col-start-2 row-start-3">
          <button onTouchStart={(e) => {e.preventDefault(); handleTouch('D')}} onMouseDown={() => handleTouch('D')} className="w-full h-full bg-gray-800 rounded-xl active:bg-blue-600 flex items-center justify-center border-b-4 border-black active:border-b-0 active:translate-y-1"><Minus className="rotate-90" /></button>
        </div>
      </div>
    </div>
  );
};

// --- REFLEKS TESTÄ° (DEÄžÄ°ÅžMEDÄ°) ---
const ReflexTest = () => {
  const [state, setState] = useState('idle'); // idle, waiting, now, result, early
  const [startT, setStartT] = useState(0);
  const [res, setRes] = useState(null);
  const timeoutRef = useRef(null);

  useEffect(() => {
    return () => {
      if (timeoutRef.current) clearTimeout(timeoutRef.current);
    };
  }, []);

  const handleStartGame = (e) => {
    e.stopPropagation(); 
    setState('waiting');
    setRes(null);
    
    timeoutRef.current = setTimeout(() => {
      setState('now');
      setStartT(Date.now());
    }, 2000 + Math.random() * 3000);
  };

  const handleAction = () => {
    if (state === 'idle' || state === 'result') return; 

    if (state === 'waiting') {
      if (timeoutRef.current) clearTimeout(timeoutRef.current);
      setState('early');
    } else if (state === 'now') {
      const finalTime = Date.now() - startT;
      setRes(finalTime);
      setState('result');
    } else if (state === 'early') {
      setState('idle');
    }
  };

  return (
    <div 
      onMouseDown={handleAction}
      onTouchStart={(e) => { if(state !== 'idle' && state !== 'result') { e.preventDefault(); handleAction(); }}}
      className={`flex flex-col items-center justify-center h-full w-full select-none transition-all duration-300 p-8 text-center
        ${state === 'idle' ? 'bg-gray-800' : ''}
        ${state === 'waiting' ? 'bg-red-900 cursor-pointer' : ''}
        ${state === 'now' ? 'bg-green-500 cursor-pointer' : ''}
        ${state === 'result' ? 'bg-blue-900' : ''}
        ${state === 'early' ? 'bg-orange-800 cursor-pointer' : ''}
      `}
    >
      {state === 'idle' && (
        <div className="animate-bounce-in flex flex-col items-center">
          <Activity size={80} className="mb-6 text-gray-400" />
          <h2 className="text-3xl font-bold text-white mb-2">Refleks Testi</h2>
          <p className="text-gray-400 mb-8 max-w-xs">KÄ±rmÄ±zÄ± ekranda bekle, YeÅŸil olunca hemen bas!</p>
          <Button onClick={handleStartGame} variant="primary" className="px-8 py-4 text-xl">BAÅžLA</Button>
        </div>
      )}
      
      {state === 'waiting' && (
        <div className="pointer-events-none">
          <h2 className="text-4xl font-bold text-red-200 tracking-widest mb-4">BEKLE...</h2>
          <p className="text-red-300 text-sm">(YeÅŸil olunca ekrana dokun)</p>
        </div>
      )}
      
      {state === 'now' && (
        <div className="pointer-events-none transform scale-125 transition-transform">
          <h2 className="text-6xl font-black text-white">BAS!</h2>
        </div>
      )}
      
      {state === 'result' && (
        <div className="animate-scale-in flex flex-col items-center">
          <div className="text-8xl font-mono font-bold text-white mb-2">{res} <span className="text-2xl text-gray-400">ms</span></div>
          <p className="text-blue-300 mb-8">
            {res < 200 ? "Ä°nanÄ±lmaz HÄ±z! âš¡" : res < 300 ? "Ã‡ok Ä°yisin! ðŸ”¥" : "Daha HÄ±zlÄ± Olabilirsin ðŸ¢"}
          </p>
          <Button onClick={() => setState('idle')} variant="secondary">Tekrar Dene</Button>
        </div>
      )}
      
      {state === 'early' && (
        <div className="pointer-events-none">
          <h2 className="text-4xl font-bold text-orange-200 mb-2">Ã‡ok Acelecisin!</h2>
          <p className="text-orange-300">YeÅŸil rengi gÃ¶rmeden basma.</p>
          <p className="mt-4 text-sm text-white/50">(Tekrar denemek iÃ§in ekrana dokun)</p>
        </div>
      )}
    </div>
  );
};

// --- GELÄ°ÅžTÄ°RÄ°LMÄ°Åž KARAR Ã‡ARKI ---
const DecisionMaker = () => {
  const [dice, setDice] = useState(1);
  const [rolling, setRolling] = useState(false);
  const [coin, setCoin] = useState(null); 
  const [flipping, setFlipping] = useState(false);
  const [optionsInput, setOptionsInput] = useState("Evet,HayÄ±r,Belki");
  const [options, setOptions] = useState(["Evet", "HayÄ±r", "Belki"]);
  const [wheelResult, setWheelResult] = useState(null);
  const [isSpinning, setIsSpinning] = useState(false);
  const [activeTab, setActiveTab] = useState('random'); // 'random' or 'custom'

  useEffect(() => {
    // Input deÄŸiÅŸtiÄŸinde seÃ§enekleri gÃ¼ncelle
    const opts = optionsInput.split(/[,\n]/).map(o => o.trim()).filter(o => o.length > 0);
    setOptions(opts.length > 0 ? opts : ["BoÅŸ"]);
  }, [optionsInput]);

  const rollDice = () => {
    if(rolling) return;
    setRolling(true);
    let count = 0;
    const interval = setInterval(() => {
      setDice(Math.floor(Math.random() * 6) + 1);
      count++;
      if(count > 10) {
        clearInterval(interval);
        setRolling(false);
      }
    }, 100);
  };

  const flipCoin = () => {
    if(flipping) return;
    setFlipping(true);
    setCoin(null);
    setTimeout(() => {
      setCoin(Math.random() > 0.5 ? 'YazÄ±' : 'Tura');
      setFlipping(false);
    }, 1000);
  };

  const spinWheel = () => {
    if(isSpinning || options.length === 0) return;
    setIsSpinning(true);
    setWheelResult(null);

    // Rastgele dÃ¶nme simÃ¼lasyonu
    let finalIndex = Math.floor(Math.random() * options.length);
    let count = 0;
    const interval = setInterval(() => {
      setWheelResult(options[count % options.length]);
      count++;
      if(count > 20 + finalIndex) { // Garanti dÃ¶nÃ¼ÅŸ sayÄ±sÄ± + final index
        clearInterval(interval);
        setIsSpinning(false);
        setWheelResult(options[finalIndex]);
      }
    }, 100);
  };

  return (
    <div className="flex flex-col h-full items-center p-6 gap-6 animate-fade-in overflow-y-auto custom-scrollbar">
      
      {/* Tab Navigasyon */}
      <div className="flex w-full max-w-lg mb-4 bg-gray-800/50 rounded-lg p-1 border border-gray-700">
        <button 
          onClick={() => setActiveTab('random')}
          className={`flex-1 py-2 font-bold rounded-md transition-all ${activeTab === 'random' ? 'bg-blue-600 text-white shadow-md' : 'text-gray-400 hover:bg-gray-700'}`}
        >
          Klasik Rastgele
        </button>
        <button 
          onClick={() => setActiveTab('custom')}
          className={`flex-1 py-2 font-bold rounded-md transition-all ${activeTab === 'custom' ? 'bg-blue-600 text-white shadow-md' : 'text-gray-400 hover:bg-gray-700'}`}
        >
          Ã–zel Ã‡ark
        </button>
      </div>

      {activeTab === 'random' && (
        <div className="flex flex-col gap-6 w-full max-w-lg">
          {/* Zar BÃ¶lÃ¼mÃ¼ */}
          <Card className="p-6 flex flex-col items-center bg-gray-800/70">
            <h3 className="text-blue-400 font-bold mb-4 flex items-center gap-2"><Dice5 /> Zar At</h3>
            <div 
              onClick={rollDice}
              className={`w-24 h-24 bg-gray-700 rounded-2xl flex items-center justify-center text-5xl font-bold text-white shadow-inner cursor-pointer transition-transform ${rolling ? 'animate-[spin_0.5s_linear_infinite]' : 'hover:scale-105'}`}
            >
              {dice}
            </div>
            <p className="text-xs text-gray-500 mt-2">Dokunarak at</p>
          </Card>

          {/* YazÄ± Tura BÃ¶lÃ¼mÃ¼ */}
          <Card className="p-6 flex flex-col items-center bg-gray-800/70">
            <h3 className="text-yellow-400 font-bold mb-4 flex items-center gap-2"><Shield /> YazÄ± Tura</h3>
            <div onClick={flipCoin} className="cursor-pointer">
              <div className={`w-24 h-24 rounded-full border-4 flex items-center justify-center shadow-lg transition-transform duration-500 ${flipping ? 'bg-gray-600 border-gray-400 animate-spin-3d' : coin === 'YazÄ±' ? 'bg-green-500 border-green-300' : coin === 'Tura' ? 'bg-red-500 border-red-300' : 'bg-gray-500 border-gray-400'}`}>
                <span className="text-xl font-bold text-gray-900 shadow-sm">
                  {coin || '?'}
                </span>
              </div>
            </div>
            <p className="text-xs text-gray-500 mt-2">{flipping ? 'DÃ¶nÃ¼yor...' : 'Dokunarak Ã§evir'}</p>
          </Card>
        </div>
      )}

      {activeTab === 'custom' && (
        <div className="flex flex-col gap-6 w-full max-w-lg">
          <Card className="p-6 flex flex-col bg-gray-800/70">
            <h3 className="text-pink-400 font-bold mb-4 flex items-center gap-2"><Grid3X3 /> Ã–zel Ã‡ark</h3>
            <p className="text-gray-400 text-sm mb-3">SeÃ§enekleri virgÃ¼l (,) veya yeni satÄ±r ile ayÄ±rarak giriniz.</p>

            <textarea 
              value={optionsInput}
              onChange={(e) => setOptionsInput(e.target.value)}
              rows="4"
              className="w-full bg-gray-900 text-white p-3 rounded-lg border border-gray-700 focus:ring-blue-500 focus:border-blue-500 mb-4 resize-none"
              placeholder="Pizza, Hamburger, Salata..."
            />
            
            <Button onClick={spinWheel} disabled={isSpinning || options.length === 0} variant="info" className="w-full py-3 text-lg">
              {isSpinning ? 'DÃ¶nÃ¼yor...' : 'Ã‡evir!'}
            </Button>
            
            <div className="mt-6 text-center">
              <p className="text-gray-400 text-sm mb-2">SeÃ§im:</p>
              <div className={`text-4xl font-black font-mono tracking-wider transition-all duration-300 ${isSpinning ? 'text-gray-500 animate-pulse' : 'text-green-400 animate-scale-in'}`}>
                {wheelResult || '...'}
              </div>
              <p className="text-xs text-gray-500 mt-4">Toplam SeÃ§enek: {options.length}</p>
            </div>
          </Card>
        </div>
      )}
    </div>
  );
};

// --- YENÄ°: HAFIZA TESTÄ° ---
const MemoryTest = () => {
  const [sequence, setSequence] = useState([]);
  const [userClicks, setUserClicks] = useState([]);
  const [gameState, setGameState] = useState('idle'); // idle, showing, testing, failed, passed
  const [currentLevel, setCurrentLevel] = useState(1);
  const [activeButton, setActiveButton] = useState(null);
  
  const COLORS = ['bg-red-600', 'bg-green-600', 'bg-blue-600', 'bg-yellow-600'];
  const BRIGHT_COLORS = ['bg-red-400 shadow-red-500/80', 'bg-green-400 shadow-green-500/80', 'bg-blue-400 shadow-blue-500/80', 'bg-yellow-400 shadow-yellow-500/80'];

  const buttons = [
    { id: 0, color: 'red' }, { id: 1, color: 'green' },
    { id: 2, color: 'blue' }, { id: 3, color: 'yellow' }
  ];

  const startGame = () => {
    setSequence([]);
    setUserClicks([]);
    setCurrentLevel(1);
    setGameState('showing');
    setTimeout(() => addNewStep([]), 500);
  };
  
  const addNewStep = (currentSeq) => {
    const newSeq = [...currentSeq, Math.floor(Math.random() * 4)];
    setSequence(newSeq);
    showSequence(newSeq);
  };

  const showSequence = (seq) => {
    setGameState('showing');
    let i = 0;
    const interval = setInterval(() => {
      if (i < seq.length) {
        setActiveButton(seq[i]);
        setTimeout(() => setActiveButton(null), 300);
        i++;
      } else {
        clearInterval(interval);
        setGameState('testing');
        setUserClicks([]);
      }
    }, 600);
  };

  const handleUserClick = (id) => {
    if (gameState !== 'testing') return;

    const newClicks = [...userClicks, id];
    setUserClicks(newClicks);
    
    // AnlÄ±k geri bildirim
    setActiveButton(id);
    setTimeout(() => setActiveButton(null), 100);

    // Kontrol
    const currentStep = newClicks.length - 1;
    if (newClicks[currentStep] !== sequence[currentStep]) {
      setGameState('failed');
      return;
    }

    // BaÅŸarÄ±lÄ±, sÄ±ra tamamlandÄ± mÄ±?
    if (newClicks.length === sequence.length) {
      setGameState('passed');
      setCurrentLevel(l => l + 1);
      setTimeout(() => addNewStep(sequence), 1000);
    }
  };

  const getButtonClass = (id) => {
    const base = 'w-1/2 h-1/2 rounded-lg m-1 transition-all duration-100 ease-out shadow-2xl border-4 border-black active:scale-[0.98]';
    const isLit = activeButton === id;
    
    return `${base} 
            ${COLORS[id]} 
            ${isLit ? BRIGHT_COLORS[id] + ' scale-105' : 'opacity-70 hover:opacity-100'}
            ${gameState === 'testing' ? 'cursor-pointer' : 'cursor-not-allowed'}
    `;
  }

  return (
    <div className="flex flex-col h-full items-center justify-center p-6 animate-fade-in select-none">
      <Card className="w-full max-w-sm p-6 flex flex-col items-center">
        <h3 className="text-3xl font-black text-white mb-4">HafÄ±za Testi</h3>
        <div className="text-lg font-bold mb-4 text-blue-400">
          Seviye: {currentLevel}
        </div>

        <div className="w-64 h-64 bg-gray-900 rounded-xl flex flex-wrap justify-center items-center shadow-inner p-2 relative">
          
          {buttons.map(btn => (
            <div 
              key={btn.id}
              className={getButtonClass(btn.id)}
              onMouseDown={() => handleUserClick(btn.id)}
              onTouchStart={(e) => { e.preventDefault(); handleUserClick(btn.id); }}
            ></div>
          ))}

          {/* Overlay DurumlarÄ± */}
          {gameState === 'idle' && (
            <div className="absolute inset-0 bg-black/80 flex items-center justify-center rounded-xl">
              <Button onClick={startGame} variant="success" className="text-xl px-6 py-3">BaÅŸla</Button>
            </div>
          )}

          {gameState === 'showing' && (
            <div className="absolute inset-0 bg-black/70 flex items-center justify-center rounded-xl">
              <p className="text-xl font-bold text-yellow-400 animate-pulse">SIRAYI Ä°ZLE</p>
            </div>
          )}

          {gameState === 'failed' && (
            <div className="absolute inset-0 bg-red-900/90 flex flex-col items-center justify-center rounded-xl">
              <p className="text-3xl font-black text-white mb-4">HATA!</p>
              <p className="text-sm text-red-200 mb-6">Seriyi kaybettin.</p>
              <Button onClick={startGame} variant="danger">Tekrar Dene</Button>
            </div>
          )}

          {gameState === 'passed' && (
            <div className="absolute inset-0 bg-green-900/90 flex flex-col items-center justify-center rounded-xl">
              <p className="text-3xl font-black text-white mb-4">BAÅžARILI!</p>
              <p className="text-sm text-green-200 mb-6">Yeni Seviyeye HazÄ±rlanÄ±lÄ±yor...</p>
            </div>
          )}
        </div>
        
        <p className="text-xs text-gray-500 mt-4">
          {gameState === 'testing' ? `SÄ±ra sende! Kalan: ${sequence.length - userClicks.length}` : ''}
        </p>

      </Card>
    </div>
  );
};


// --- Ä°LGÄ°NÃ‡ BÄ°LGÄ°LER (DEÄžÄ°ÅžMEDÄ°) ---
const KnowledgeBase = () => {
  const [index, setIndex] = useState(0);

  return (
    <div className="flex flex-col h-full items-center justify-center p-6 space-y-8 animate-fade-in">
      <div className="w-full max-w-2xl bg-gray-800/80 backdrop-blur p-8 rounded-2xl border border-blue-500/30 shadow-[0_0_30px_rgba(59,130,246,0.15)] relative overflow-hidden group">
        <div className="absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity transform group-hover:rotate-12 duration-500">
          <Lightbulb size={150} />
        </div>
        
        <h3 className="text-blue-400 font-bold uppercase tracking-widest mb-6 flex items-center gap-3">
          <BookOpen size={24}/> BunlarÄ± Biliyor Muydun?
        </h3>
        
        <div className="min-h-[140px] flex items-center relative z-10">
          <p className="text-xl md:text-2xl text-gray-100 font-light leading-relaxed">
            "{FACTS[index]}"
          </p>
        </div>

        <div className="mt-8 flex gap-3 relative z-10">
          <Button 
            onClick={() => setIndex(Math.floor(Math.random() * FACTS.length))} 
            variant="secondary" 
            className="flex-1"
          >
            Rastgele
          </Button>
          <Button 
            onClick={() => setIndex((index + 1) % FACTS.length)} 
            className="flex-1"
          >
            SÄ±radaki
          </Button>
        </div>
        <div className="text-center mt-2 text-xs text-gray-600">Total: {FACTS.length} bilgi</div>
      </div>
    </div>
  );
};

// --- OFFLINE NOTLAR (DÃœZENLEME EKLENDÄ°) ---
const OfflineDiary = () => {
  const [notes, setNotes] = useState([]);
  const [text, setText] = useState('');
  const [editingId, setEditingId] = useState(null);

  useEffect(() => {
    const saved = localStorage.getItem('myOfflineNotes_v2');
    if (saved) setNotes(JSON.parse(saved));
  }, []);
  
  useEffect(() => {
     localStorage.setItem('myOfflineNotes_v2', JSON.stringify(notes));
  }, [notes]);

  const saveNote = () => {
    if(!text.trim()) return;
    
    if (editingId) {
      // DÃ¼zenleme modu
      const updatedNotes = notes.map(n => 
        n.id === editingId ? { ...n, text, date: new Date().toLocaleDateString() + ' (DÃ¼zenlendi)' } : n
      );
      setNotes(updatedNotes);
      setEditingId(null);
    } else {
      // Yeni not modu
      const newNotes = [{ id: Date.now(), text, date: new Date().toLocaleDateString() }, ...notes];
      setNotes(newNotes);
    }
    setText('');
  };
  
  const startEditing = (note) => {
    setText(note.text);
    setEditingId(note.id);
  };
  
  const cancelEditing = () => {
    setText('');
    setEditingId(null);
  };

  const deleteNote = (id) => {
    const newNotes = notes.filter(n => n.id !== id);
    setNotes(newNotes);
  };

  return (
    <div className="flex flex-col h-full p-4 md:p-6 gap-4 animate-fade-in">
      <div className="bg-gray-800 p-4 rounded-xl border border-gray-700">
        <textarea 
          value={text}
          onChange={(e) => setText(e.target.value)}
          className="w-full bg-transparent text-white resize-none focus:outline-none placeholder-gray-500 h-24"
          placeholder={editingId ? "Notu dÃ¼zenliyorsun..." : "AklÄ±na geleni hemen buraya yaz..."}
        />
        <div className="flex justify-between items-center mt-2 border-t border-gray-700 pt-2">
          <span className="text-xs text-gray-500">Sadece bu cihazda saklanÄ±r.</span>
          <div className="flex gap-2">
            {editingId && (
              <Button onClick={cancelEditing} variant="secondary" className="px-3 py-1 text-sm">Ä°ptal</Button>
            )}
            <Button onClick={saveNote} className="px-6 py-1 text-sm" variant={editingId ? 'info' : 'primary'}>
              {editingId ? 'Kaydet' : 'Ekle'}
            </Button>
          </div>
        </div>
      </div>

      <div className="flex-1 overflow-y-auto space-y-3 custom-scrollbar">
        {notes.length === 0 && (
          <div className="text-center text-gray-500 mt-10">HenÃ¼z not yok.</div>
        )}
        {notes.map(n => (
          <div key={n.id} className="bg-gray-800/50 p-4 rounded-lg border border-gray-700/50 flex justify-between group hover:bg-gray-800 transition-colors">
            <div className="flex-1 pr-4">
              <p className="text-gray-200 whitespace-pre-wrap break-words">{n.text}</p>
              <p className="text-[10px] text-gray-500 mt-2 flex items-center gap-1"><Clock size={10} /> {n.date}</p>
            </div>
            <div className="flex gap-2 self-start">
              <button onClick={() => startEditing(n)} className="text-gray-500 hover:text-yellow-400 opacity-0 group-hover:opacity-100 transition-opacity p-2">
                <Edit size={16} />
              </button>
              <button onClick={() => deleteNote(n.id)} className="text-gray-600 hover:text-red-400 opacity-0 group-hover:opacity-100 transition-opacity p-2">
                <Trash2 size={16} />
              </button>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

// --- BÄ°LMECELER (DEÄžÄ°ÅžMEDÄ°) ---
const BrainStation = () => {
  const [current, setCurrent] = useState(0);
  const [show, setShow] = useState(false);

  return (
    <div className="flex flex-col h-full items-center justify-center p-6 animate-fade-in">
      <Card className="w-full max-w-lg p-8 relative">
        <div className="flex items-center gap-3 text-purple-400 mb-8">
          <Ghost size={32} />
          <h3 className="text-2xl font-bold">Zeka SorularÄ±</h3>
        </div>
        
        <div className="min-h-[100px] text-center mb-8">
          <p className="text-xl text-white font-medium">{RIDDLES[current].q}</p>
        </div>
        
        <div className={`p-4 rounded-lg text-center font-bold text-xl transition-all duration-300 transform ${show ? 'bg-purple-900/40 text-purple-200 scale-100' : 'bg-gray-900/50 text-transparent scale-95 select-none'}`}>
          {RIDDLES[current].a || "."}
        </div>

        <div className="flex gap-4 mt-8">
          <Button onClick={() => setShow(!show)} variant="secondary" className="flex-1">
            {show ? 'Gizle' : 'CevabÄ± GÃ¶r'}
          </Button>
          <Button onClick={() => {setShow(false); setCurrent((current + 1) % RIDDLES.length);}} className="flex-1 bg-purple-600 hover:bg-purple-500 shadow-purple-900/50">
            SÄ±radaki
          </Button>
        </div>
        <div className="absolute top-4 right-4 text-xs text-gray-600">#{current + 1}</div>
      </Card>
    </div>
  );
};

// --- ANA APP ---
const App = () => {
  const [activeTab, setActiveTab] = useState('clicker');
  const [menuOpen, setMenuOpen] = useState(false);

  const MENU = [
    { id: 'clicker', label: 'Siber Madenci', icon: <Gamepad2 /> },
    { id: 'snake', label: 'YÄ±lan Oyunu', icon: <Trophy /> },
    { id: 'reflex', label: 'Refleks Testi', icon: <Activity /> },
    { id: 'memory', label: 'HafÄ±za Testi', icon: <Brain /> }, // Yeni eklendi
    { id: 'decision', label: 'Karar Ã‡arkÄ±', icon: <Dice5 /> },
    { id: 'knowledge', label: 'Bilgi Deposu', icon: <Lightbulb /> },
    { id: 'brain', label: 'Bilmeceler', icon: <Ghost /> },
    { id: 'diary', label: 'Gizli Notlar', icon: <Save /> },
  ];

  return (
    <div className="bg-gray-950 text-gray-100 h-screen w-full font-sans flex flex-col overflow-hidden selection:bg-blue-500/30 selection:text-blue-200">
      {/* Header */}
      <header className="h-16 bg-gray-900/80 backdrop-blur-md border-b border-gray-800 flex justify-between items-center px-4 md:px-6 z-30 shrink-0 shadow-lg">
        <div className="flex items-center gap-3">
          <div className="w-8 h-8 bg-gradient-to-br from-blue-600 to-indigo-600 rounded-lg flex items-center justify-center shadow-[0_0_15px_rgba(37,99,235,0.5)]">
            <Zap size={20} className="text-white" fill="white" />
          </div>
          <div>
            <h1 className="font-bold text-lg leading-none tracking-tight">OFFLINE PRO</h1>
            <span className="text-[10px] text-gray-500 font-mono">v5.0 Pro Max</span>
          </div>
        </div>
        <button onClick={() => setMenuOpen(!menuOpen)} className="md:hidden p-2 text-gray-400 hover:text-white hover:bg-gray-800 rounded-lg transition-colors">
          {menuOpen ? <X /> : <Menu />}
        </button>
      </header>

      <div className="flex flex-1 overflow-hidden relative">
        {/* Sidebar */}
        <aside className={`
          absolute md:relative z-20 h-full w-64 bg-gray-900 border-r border-gray-800 transform transition-transform duration-300 ease-in-out flex flex-col shadow-2xl md:shadow-none
          ${menuOpen ? 'translate-x-0' : '-translate-x-full md:translate-x-0'}
        `}>
          <div className="p-3 space-y-1 flex-1 overflow-y-auto custom-scrollbar">
            <div className="text-xs font-bold text-gray-600 uppercase tracking-wider px-4 py-2 mt-2">MenÃ¼</div>
            {MENU.map(item => (
              <button
                key={item.id}
                onClick={() => { setActiveTab(item.id); setMenuOpen(false); }}
                className={`w-full flex items-center gap-3 px-4 py-3 rounded-xl transition-all duration-200 group relative overflow-hidden ${
                  activeTab === item.id 
                    ? 'bg-blue-600 text-white shadow-lg shadow-blue-900/50' 
                    : 'text-gray-400 hover:bg-gray-800 hover:text-gray-100'
                }`}
              >
                <span className={`transition-transform duration-300 ${activeTab === item.id ? 'scale-110' : 'group-hover:scale-110'}`}>{item.icon}</span>
                <span className="font-medium">{item.label}</span>
              </button>
            ))}
          </div>
        </aside>

        {/* Overlay for mobile menu */}
        {menuOpen && <div onClick={() => setMenuOpen(false)} className="absolute inset-0 bg-black/50 z-10 md:hidden backdrop-blur-sm"></div>}

        {/* Main Content */}
        <main className="flex-1 relative bg-gray-950 w-full overflow-hidden flex flex-col">
          <div className="flex-1 overflow-y-auto scroll-smooth custom-scrollbar">
            <div className="max-w-4xl mx-auto h-full min-h-full">
               {activeTab === 'clicker' && <ClickerGame />}
               {activeTab === 'snake' && <SnakeGame />}
               {activeTab === 'reflex' && <ReflexTest />}
               {activeTab === 'memory' && <MemoryTest />}
               {activeTab === 'decision' && <DecisionMaker />}
               {activeTab === 'knowledge' && <KnowledgeBase />}
               {activeTab === 'brain' && <BrainStation />}
               {activeTab === 'diary' && <OfflineDiary />}
            </div>
          </div>
        </main>
      </div>

      <style>{`
        .custom-scrollbar::-webkit-scrollbar { width: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: transparent; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background-color: #374151; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background-color: #4b5563; }
        @keyframes float-up { 0% { opacity: 1; transform: translateY(0) scale(1); } 100% { opacity: 0; transform: translateY(-80px) scale(1.2); } }
        .animate-float-up { animation: float-up 0.8s ease-out forwards; }
        .animate-fade-in { animation: fadeIn 0.3s ease-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes spin-3d { 0% { transform: rotateY(0deg); } 100% { transform: rotateY(360deg); } }
        .animate-spin-3d { animation: spin-3d 0.5s linear infinite; }
        @keyframes scale-in { 0% { transform: scale(0.8); opacity: 0; } 100% { transform: scale(1); opacity: 1; } }
        .animate-scale-in { animation: scale-in 0.3s ease-out; }
      `}</style>
    </div>
  );
};

export default App;

